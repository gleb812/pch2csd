;@ map PANLOG

;@ ins k k
;@ outs k k
opcode Fade1, 0, kkkkkkk
  kmod,kPan,kLogLin, kin,kmodin,koutL,koutR xin
  kIn zkr kin
  kMod zkr kmodin

  kM = kmod * kMod ;* 1/64

    kPL table 2 * kPan + kM, giPANLOG
    kPR table (127 - 2* kPan - kM), giPANLOG

  kL = kPL * kIn
  kR = kPR * kIn

  zkw kL, koutL
  zkw kR, koutR
endop

;@ ins a a
;@ outs a a
opcode Fade1, 0, kkkkkkk
  kmod,kPan,kLogLin, kin,kmodin,koutL,koutR xin
  aIn zar kin
  aMod zar kmodin

  aM = amod * aMod ;* 1/64

  kPL table 2 * kPan + kM, giPANLOG
  kPR table (127 - 2* kPan - kM), giPANLOG

  aL = aPL * aIn
  aR = aPR * aIn

  zaw aL, koutL
  zaw aR, koutR
endop
