;@ ins k k k k k k k k k
;@ outs k
opcode Mux81X, 0, kkkkkkkkkkk
  kx,k1,k2,k3,k4,k5,k6,k7,k8,kc,ko xin
  kCtrl zkr kc
  ki1 zkr k1
  ki2 zkr k2
  ki3 zkr k3
  ki4 zkr k4
  ki5 zkr k5
  ki6 zkr k6
  ki7 zkr k7
  ki8 zkr k8

  kx -= 51
  if kx <0 then
    kx = 0
  endif

  kCross[][] init 77,18
  kCross fillarray
  1,1,1,1,1,1,1,1,0.6310,0.0000,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5821,0.0079,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5821,0.0138,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5754,0.0195,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5754,0.0254,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5754,0.0313,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5754,0.0372,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5754,0.0432,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5754,0.0490,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5754,0.0543,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5689,0.0603,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5689,0.0661,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5689,0.0724,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5689,0.0776,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5689,0.0841,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5689,0.0902,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5623,0.0955,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5623,0.1012,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5623,0.1072,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5623,0.1135,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5623,0.1189,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5623,0.1245,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9886,0.5623,0.1303,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9772,0.5559,0.1365,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9772,0.5559,0.1429,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9661,0.5559,0.1479,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9550,0.5559,0.1531,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9550,0.5559,0.1603,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9441,0.5559,0.1660,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9333,0.5559,0.1718,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9226,0.5495,0.1778,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9226,0.5495,0.1841,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9120,0.5495,0.1884,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9016,0.5495,0.1950,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8913,0.5495,0.1995,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8913,0.5495,0.2065,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8810,0.5433,0.2113,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8710,0.5433,0.2188,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8610,0.5433,0.2239,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8610,0.5433,0.2291,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8511,0.5433,0.2344,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8414,0.5433,0.2427,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8318,0.5370,0.2483,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8222,0.5370,0.2541,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8128,0.5370,0.2600,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8128,0.5370,0.2661,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8035,0.5370,0.2692,0.0050,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.7943,0.5370,0.2754,0.0178,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.7852,0.5370,0.2818,0.0305,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.7762,0.5309,0.2884,0.0432,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.7674,0.5309,0.2951,0.0556,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.7586,0.5309,0.2985,0.0684,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.9772,0.7499,0.5309,0.3055,0.0813,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.9661,0.7413,0.5309,0.3126,0.0933,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.9550,0.7328,0.5309,0.3162,0.1059,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.9333,0.7244,0.5248,0.3236,0.1189,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.9226,0.7161,0.5248,0.3273,0.1318,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.9120,0.7079,0.5248,0.3350,0.1445,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.8913,0.7079,0.5248,0.3388,0.1567,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.8810,0.6998,0.5248,0.3467,0.1698,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.8610,0.6918,0.5248,0.3508,0.1820,0.0119,0,0,0,0,0,0,
  1,1,1,1,1,1,0.8511,0.6839,0.5188,0.3589,0.1950,0.0313,0,0,0,0,0,0,
  1,1,1,1,1,0.9886,0.8318,0.6761,0.5188,0.3631,0.2065,0.0507,0,0,0,0,0,0,
  1,1,1,1,1,0.9661,0.8222,0.6683,0.5188,0.3715,0.2213,0.0700,0,0,0,0,0,0,
  1,1,1,1,1,0.9441,0.8035,0.6607,0.5188,0.3758,0.2317,0.0902,0,0,0,0,0,0,
  1,1,1,1,1,0.9226,0.7943,0.6531,0.5188,0.3802,0.2455,0.1096,0,0,0,0,0,0,
  1,1,1,1,1,0.9016,0.7762,0.6457,0.5188,0.3890,0.2570,0.1288,0,0,0,0,0,0,
  1,1,1,1,1,0.8810,0.7586,0.6383,0.5188,0.3936,0.2692,0.1479,0.0257,0,0,0,0,0,
  1,1,1,1,0.9772,0.8610,0.7499,0.6310,0.5188,0.3981,0.2818,0.1679,0.0519,0,0,0,0,0,
  1,1,1,1,0.9550,0.8414,0.7328,0.6237,0.5129,0.4027,0.2951,0.1862,0.0785,0,0,0,0,0,
  1,1,1,1,0.9226,0.8222,0.7161,0.6166,0.5129,0.4121,0.3090,0.2065,0.1047,0,0,0,0,0,
  1,1,1,0.9886,0.8913,0.7943,0.6998,0.6095,0.5129,0.4169,0.3199,0.2265,0.1303,0.0355,0,0,0,0,
  1,1,1,0.9550,0.8610,0.7762,0.6918,0.6026,0.5129,0.4217,0.3350,0.2455,0.1567,0.0684,0,0,0,0,
  1,1,1,0.9226,0.8414,0.7586,0.6761,0.5888,0.5129,0.4266,0.3467,0.2661,0.1841,0.1012,0.0197,0,0,0,
  1,1,0.9550,0.8810,0.8128,0.7328,0.6607,0.5821,0.5070,0.4365,0.3589,0.2851,0.2089,0.1349,0.0596,0,0,0,
  1,0.9886,0.9120,0.8511,0.7762,0.7161,0.6457,0.5754,0.5070,0.4416,0.3715,0.3055,0.2371,0.1679,0.1000,0.0316,0,0,
  1,0.9333,0.8710,0.8128,0.7499,0.6918,0.6310,0.5689,0.5070,0.4467,0.3846,0.3236,0.2630,0.2018,0.1396,0.0785,0.0172,0

  kCtrl *= 127

  if kCtrl < 19 then
    kOut = ki1*kCross[kx][kCtrl] + ki2*kCross[kx][18-kCtrl]
    goto Over
  elseif kCtrl < 37 then
    kOut = ki2*kCross[kx][kCtrl-19] + ki3*kCross[kx][37-kCtrl-19]
    goto Over
  elseif kCtrl < 55 then
    kOut = ki3*kCross[kx][kCtrl-37] + ki4*kCross[kx][55-kCtrl-37]
    goto Over
  elseif kCtrl < 73 then
    kOut = ki4*kCross[kx][kCtrl-55] + ki5*kCross[kx][73-kCtrl-55]
    goto Over
  elseif kCtrl < 91 then
    kOut = ki5*kCross[kx][kCtrl-73] + ki6*kCross[kx][91-kCtrl-73]
    goto Over
  elseif kCtrl < 109 then
    kOut = ki6*kCross[kx][kCtrl-91] + ki7*kCross[kx][109-kCtrl-91]
    goto Over
  else
    kOut = ki7*kCross[kx][kCtrl-109] + ki8*kCross[kx][127-kCtrl]
  endif
Over:
  zkw kOut, ko
endop

;@ ins k a a a a a a a a
;@ outs a
opcode Mux81X, 0, kkkkkkkkkkk
  kx,k1,k2,k3,k4,k5,k6,k7,k8,kc,ko xin
  kCtrl zkr kc
  ai1 zar k1
  ai2 zar k2
  ai3 zar k3
  ai4 zar k4
  ai5 zar k5
  ai6 zar k6
  ai7 zar k7
  ai8 zar k8

  kx -= 51
  if kx <0 then
    kx = 0
  endif

  kCross[][] init 77,18
  kCross fillarray
  1,1,1,1,1,1,1,1,0.6310,0.0000,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5821,0.0079,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5821,0.0138,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5754,0.0195,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5754,0.0254,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5754,0.0313,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5754,0.0372,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5754,0.0432,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5754,0.0490,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5754,0.0543,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5689,0.0603,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5689,0.0661,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5689,0.0724,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5689,0.0776,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5689,0.0841,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5689,0.0902,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5623,0.0955,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5623,0.1012,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5623,0.1072,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5623,0.1135,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5623,0.1189,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,0.5623,0.1245,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9886,0.5623,0.1303,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9772,0.5559,0.1365,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9772,0.5559,0.1429,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9661,0.5559,0.1479,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9550,0.5559,0.1531,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9550,0.5559,0.1603,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9441,0.5559,0.1660,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9333,0.5559,0.1718,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9226,0.5495,0.1778,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9226,0.5495,0.1841,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9120,0.5495,0.1884,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.9016,0.5495,0.1950,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8913,0.5495,0.1995,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8913,0.5495,0.2065,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8810,0.5433,0.2113,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8710,0.5433,0.2188,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8610,0.5433,0.2239,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8610,0.5433,0.2291,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8511,0.5433,0.2344,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8414,0.5433,0.2427,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8318,0.5370,0.2483,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8222,0.5370,0.2541,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8128,0.5370,0.2600,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8128,0.5370,0.2661,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.8035,0.5370,0.2692,0.0050,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.7943,0.5370,0.2754,0.0178,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.7852,0.5370,0.2818,0.0305,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.7762,0.5309,0.2884,0.0432,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.7674,0.5309,0.2951,0.0556,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,0.7586,0.5309,0.2985,0.0684,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.9772,0.7499,0.5309,0.3055,0.0813,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.9661,0.7413,0.5309,0.3126,0.0933,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.9550,0.7328,0.5309,0.3162,0.1059,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.9333,0.7244,0.5248,0.3236,0.1189,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.9226,0.7161,0.5248,0.3273,0.1318,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.9120,0.7079,0.5248,0.3350,0.1445,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.8913,0.7079,0.5248,0.3388,0.1567,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.8810,0.6998,0.5248,0.3467,0.1698,0,0,0,0,0,0,0,
  1,1,1,1,1,1,0.8610,0.6918,0.5248,0.3508,0.1820,0.0119,0,0,0,0,0,0,
  1,1,1,1,1,1,0.8511,0.6839,0.5188,0.3589,0.1950,0.0313,0,0,0,0,0,0,
  1,1,1,1,1,0.9886,0.8318,0.6761,0.5188,0.3631,0.2065,0.0507,0,0,0,0,0,0,
  1,1,1,1,1,0.9661,0.8222,0.6683,0.5188,0.3715,0.2213,0.0700,0,0,0,0,0,0,
  1,1,1,1,1,0.9441,0.8035,0.6607,0.5188,0.3758,0.2317,0.0902,0,0,0,0,0,0,
  1,1,1,1,1,0.9226,0.7943,0.6531,0.5188,0.3802,0.2455,0.1096,0,0,0,0,0,0,
  1,1,1,1,1,0.9016,0.7762,0.6457,0.5188,0.3890,0.2570,0.1288,0,0,0,0,0,0,
  1,1,1,1,1,0.8810,0.7586,0.6383,0.5188,0.3936,0.2692,0.1479,0.0257,0,0,0,0,0,
  1,1,1,1,0.9772,0.8610,0.7499,0.6310,0.5188,0.3981,0.2818,0.1679,0.0519,0,0,0,0,0,
  1,1,1,1,0.9550,0.8414,0.7328,0.6237,0.5129,0.4027,0.2951,0.1862,0.0785,0,0,0,0,0,
  1,1,1,1,0.9226,0.8222,0.7161,0.6166,0.5129,0.4121,0.3090,0.2065,0.1047,0,0,0,0,0,
  1,1,1,0.9886,0.8913,0.7943,0.6998,0.6095,0.5129,0.4169,0.3199,0.2265,0.1303,0.0355,0,0,0,0,
  1,1,1,0.9550,0.8610,0.7762,0.6918,0.6026,0.5129,0.4217,0.3350,0.2455,0.1567,0.0684,0,0,0,0,
  1,1,1,0.9226,0.8414,0.7586,0.6761,0.5888,0.5129,0.4266,0.3467,0.2661,0.1841,0.1012,0.0197,0,0,0,
  1,1,0.9550,0.8810,0.8128,0.7328,0.6607,0.5821,0.5070,0.4365,0.3589,0.2851,0.2089,0.1349,0.0596,0,0,0,
  1,0.9886,0.9120,0.8511,0.7762,0.7161,0.6457,0.5754,0.5070,0.4416,0.3715,0.3055,0.2371,0.1679,0.1000,0.0316,0,0,
  1,0.9333,0.8710,0.8128,0.7499,0.6918,0.6310,0.5689,0.5070,0.4467,0.3846,0.3236,0.2630,0.2018,0.1396,0.0785,0.0172,0

  kCtrl *= 127

  if kCtrl < 19 then
    aOut = ai1*kCross[kx][kCtrl] + ai2*kCross[kx][18-kCtrl]
    goto Over
  elseif kCtrl < 37 then
    aOut = ai2*kCross[kx][kCtrl-19] + ai3*kCross[kx][37-kCtrl-19]
    goto Over
  elseif kCtrl < 55 then
    aOut = ai3*kCross[kx][kCtrl-37] + ai4*kCross[kx][55-kCtrl-37]
    goto Over
  elseif kCtrl < 73 then
    aOut = ai4*kCross[kx][kCtrl-55] + ai5*kCross[kx][73-kCtrl-55]
    goto Over
  elseif kCtrl < 91 then
    aOut = ai5*kCross[kx][kCtrl-73] + ai6*kCross[kx][91-kCtrl-73]
    goto Over
  elseif kCtrl < 109 then
    aOut = ai6*kCross[kx][kCtrl-91] + ai7*kCross[kx][109-kCtrl-91]
    goto Over
  else
    aOut = ai7*kCross[kx][kCtrl-109] + ai8*kCross[kx][127-kCtrl]
  endif
Over:
  zaw aOut, ko
endop
