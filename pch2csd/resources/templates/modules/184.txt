;@ map s 3 AMPEXP CLA001 AMPEXP
;@ map d BUT002
;@ map d BUT003

;@ ins k k
;@ outs k
opcode Mix11A, 0, kkkkkk
  kLev, kOn, kExpLin, kin, kchain, kout  xin
  kIn zkr kin
  kChain zkr kchain

  if kExpLin == 1 goto Out
    kLev table kLev, 100, 1
  Out:
  kOut = kChain + kIn * kLev * kOn
  zkw kOut, kout
endop

;@ ins a a
;@ outs a
opcode Mix11A, 0, kkkkkk
  kLev, kOn, kExpLin, kin, kchain, kout  xin
  aIn zar kin
  aChain zar kchain

  if kExpLin == 1 goto Out
    kLev table kLev, 100, 1
  Out:
  aOut = aChain + aIn * kLev * kOn
  zaw aOut, kout
endop
